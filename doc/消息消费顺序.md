#### RabbitMQ消息消费顺序场景
一个 queue，多个 consumer。比如，生产者向RabbitMQ里发送了三条数据，顺序依次是 data1/data2/data3，压入的是RabbitMQ的一个内存队列。有三个消费者分别从MQ中消费这三条数据中的一条，结果消费者2先执行完操作，把 data2 存入数据库，然后是data1/data3。就出问题了。
  
#### Kafka消息消费顺序场景
比如说我们建了一个topic，有三个partition。生产者在写的时候，其实可以指定一个key，比如说我们指定了某个订单id作为key，那么这个订单相关的数据，一定会被分发到同一个partition中去，而且这个partition中的数据一定是有顺序的。消费者从partition中取出来数据的时候，也一定是有顺序的。到这里，顺序还是ok的，没有错乱。接着，我们在消费者里可能会搞多个线程来并发处理消息。因为如果消费者是单线程消费处理，而处理比较耗时的话，比如处理一条消息耗时几十 ms，那么1秒钟只能处理几十条消息，这吞吐量太低了。而多个线程并发跑的话，顺序可能就乱掉了。
   
#### 解决方案：
* RabbitMQ拆分多个 queue，每个 queue 一个 consumer，就是多一些 queue 而已。

* kafka
一个 topic，一个partition，一个consumer，内部单线程消费，单线程吞吐量太低，一般不会用这个。写N个内存queue，具有相同key的数据都到同一个内存queue；然后对于N个线程，每个线程分别消费一个内存queue即可，这样就能保证顺序性
